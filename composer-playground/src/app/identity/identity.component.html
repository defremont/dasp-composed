<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->
<section class="main-view">
    <div class="main-view-content">
        <section class="header modal-header">
            <h1>Welcome to DASP, sign in or log in!</h1>
            <div>
                <button [ngClass]="tabS ? 'primary' : 'secondary'" (click)="tab1()" type="button" class="">
                    <span>Sign Up</span>
                </button>
                <button [ngClass]="tabL ? 'primary' : 'secondary'"  (click)="tab2()" type="button">
                    <span>Log In</span>
                </button>
            </div>
        </section>
        <section *ngIf="tabS" class="issue-identity">
            <section class="modal-body">
                <p>
                    Issue a new ID/Participant in business network
                </p>

                <form
                    #issueIdentityForm="ngForm"
                    id="issue-identity-form"
                    (ngSubmit)="issueIdentity()"
                >
                    <div class="justified-input">
                        <label class="required" for="userID"
                            >E-mail<abbr title="required">*</abbr></label
                        >
                        <input
                            required
                            (ngModelChange)="actualFQI($event)"
                            type="text"
                            [(ngModel)]="userID"
                            id="userID"
                            name="userID"
                            autocomplete="off"
                        />
                    </div>
                    <div *ngIf="revealPass" class="justified-input">
                        <label class="required" for="secret"
                            >Secret<abbr title="required">*</abbr></label
                        >
                        <input
                            required
                            type="password"
                            [(ngModel)]="pass"
                            id="pass"
                            name="pass"
                        />
                    </div>

                    <div *ngIf="false" class="keyValue">
                        <label class="key" for="participantFQI"
                            >Participant<abbr title="required">*</abbr></label
                        >
                        <div class="value">
                            <input
                                [ngClass]="{
                                    'error-underline': !isParticipant
                                }"
                                required
                                type="text"
                                [(ngModel)]="participantFQI"
                                id="participantFQI"
                                name="participantFQI"
                                [ngbTypeahead]="search"
                                [resultTemplate]="participantTypeaheadResult"
                                autocomplete="off"
                                (ngModelChange)="isValidParticipant()"
                            />
                            <div
                                *ngIf="!isParticipant"
                                class="error-message"
                                style="position: absolute; top: 165px;"
                            >
                                {{ noMatchingParticipant }}
                            </div>
                        </div>
                    </div>
                </form>
                <h1 *ngIf="secret">GOOD! YOUR PASS: {{ secret }}</h1>
                <p>
                    Issuing an identity generates a one-time secret. You can
                    choose to send this to somebody or use it yourself when it
                    has been issued.
                </p>
            </section>

            <footer>
                <button
                    id="createNew"
                    type="submit"
                    form="issue-identity-form"
                    class="primary"
                    [disabled]="
                        !issueIdentityForm.form.valid || issueInProgress
                    "
                >
                    <div *ngIf="!issueInProgress">
                        <span>Sign Up</span>
                    </div>
                    <div
                        *ngIf="issueInProgress"
                        class="ibm-spinner-indeterminate small loop"
                    >
                        <div class="loader">
                            <svg class="circular" viewBox="25 25 50 50">
                                <circle
                                    class="circle-path"
                                    cx="50"
                                    cy="50"
                                    r="20"
                                />
                            </svg>
                        </div>
                    </div>
                </button>
            </footer>
        </section>
        <section *ngIf="tabL" class="issue-identity">
            <section class="modal-body">
                <p>
                    Log in on the business network
                </p>
                <form
                    #issueIdentityForm="ngForm"
                    id="log-in-form"
                    (ngSubmit)="logIn()"
                >
                    <div class="justified-input">
                        <label class="required" for="user"
                            >E-mail<abbr title="required">*</abbr></label
                        >
                        <input
                            required
                            type="text"
                            [(ngModel)]="user"
                            id="user"
                            name="user"
                        />
                    </div>
                    <div class="justified-input">
                        <label class="required" for="secret"
                            >Secret<abbr title="required">*</abbr></label
                        >
                        <input
                            required
                            type="password"
                            [(ngModel)]="pass"
                            id="pass"
                            name="pass"
                        />
                    </div>
                </form>
            </section>

            <footer>
                <button
                    id="createNew"
                    type="submit"
                    form="log-in-form"
                    class="primary"
                    [disabled]="
                        !issueIdentityForm.form.valid || issueInProgress
                    "
                >
                    <div *ngIf="!issueInProgress">
                        <span>Log In</span>
                    </div>
                    <div
                        *ngIf="issueInProgress"
                        class="ibm-spinner-indeterminate small loop"
                    >
                        <div class="loader">
                            <svg class="circular" viewBox="25 25 50 50">
                                <circle
                                    class="circle-path"
                                    cx="50"
                                    cy="50"
                                    r="20"
                                />
                            </svg>
                        </div>
                    </div>
                </button>
            </footer>
        </section>
    </div>
</section>
